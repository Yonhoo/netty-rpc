<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NettyServerBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">netty-rpc</a> &gt; <a href="index.source.html" class="el_package">com.yonhoo.nettyrpc.server</a> &gt; <span class="el_source">NettyServerBuilder.java</span></div><h1>NettyServerBuilder.java</h1><pre class="source lang-java linenums">package com.yonhoo.nettyrpc.server;

import java.net.InetSocketAddress;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import lombok.Getter;
import lombok.extern.slf4j.Slf4j;

<span class="fc" id="L12">@Slf4j</span>
@Getter
public class NettyServerBuilder implements ServerBuilder {

<span class="nc" id="L16">    private final InetSocketAddress listenAddress;</span>
<span class="pc" id="L17">    private final List&lt;ServerServiceDefinition&gt; serviceDefinitionList = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L18">    private final Map&lt;Object, Object&gt; channelOptionals;</span>
<span class="nc" id="L19">    private final Map&lt;Object, Object&gt; childChannelOptionals;</span>
<span class="pc" id="L20">    private final ServerConfig serverConfig = new ServerConfig();</span>

    public static NettyServerBuilder forAddress(String address, int port) {
<span class="fc" id="L23">        return new NettyServerBuilder(new InetSocketAddress(address, port));</span>
    }

<span class="fc" id="L26">    private NettyServerBuilder(InetSocketAddress address) {</span>
<span class="fc" id="L27">        this.channelOptionals = new HashMap&lt;&gt;();</span>
<span class="fc" id="L28">        this.childChannelOptionals = new HashMap&lt;&gt;();</span>
<span class="fc" id="L29">        this.listenAddress = address;</span>
<span class="fc" id="L30">    }</span>

    @Override
    public NettyServerBuilder addService(ServerServiceDefinition service) {
<span class="fc" id="L34">        serviceDefinitionList.add(service);</span>
<span class="fc" id="L35">        return this;</span>
    }

    @Override
    public ServerBuilder addTransportFilter(Object filter) {
<span class="nc" id="L40">        throw new IllegalArgumentException();</span>
    }

    @Override
    public ServerBuilder intercept(Object interceptor) {
<span class="nc" id="L45">        throw new IllegalArgumentException();</span>
    }

    /**
     * time unit MILLISECONDS
     *
     * @param connectAliveTime keep alive time when build connection
     * @return NettyServerBuilder
     */
    @Override
    public NettyServerBuilder keepAliveTime(long connectAliveTime) {
<span class="nc" id="L56">        serverConfig.setConnAliveTime(connectAliveTime);</span>
<span class="nc" id="L57">        return this;</span>
    }

    /**
     * build biz pool
     * &lt;p&gt;
     * time unit MILLISECONDS
     *
     * @param corePoolSize    executor core pool size
     * @param maximumPoolSize executor maximum pool size
     * @param keepAliveTime   thread alive time
     * @return NettyServerBuilder
     */
    @Override
    public NettyServerBuilder bizPoolConfig(int corePoolSize, int maximumPoolSize, long keepAliveTime) {
<span class="nc" id="L72">        serverConfig.setCorePoolSize(corePoolSize);</span>
<span class="nc" id="L73">        serverConfig.setMaximumPoolSize(maximumPoolSize);</span>
<span class="nc" id="L74">        serverConfig.setThreadAliveTime(keepAliveTime);</span>
<span class="nc" id="L75">        return this;</span>
    }

    /**
     * build biz pool
     * &lt;p&gt;
     * time unit MILLISECONDS
     *
     * @param corePoolSize    executor core pool size
     * @param maximumPoolSize executor maximum pool size
     * @param keepAliveTime   thread alive time
     * @param queueSize       queue size
     * @return NettyServerBuilder
     */
    @Override
    public NettyServerBuilder bizPoolConfig(int corePoolSize, int maximumPoolSize, long keepAliveTime, int queueSize) {
<span class="nc" id="L91">        serverConfig.setCorePoolSize(corePoolSize);</span>
<span class="nc" id="L92">        serverConfig.setMaximumPoolSize(maximumPoolSize);</span>
<span class="nc" id="L93">        serverConfig.setThreadAliveTime(keepAliveTime);</span>
<span class="nc" id="L94">        serverConfig.setQueueSize(queueSize);</span>
<span class="nc" id="L95">        return this;</span>
    }

    @Override
    public NettyServer build() {
<span class="fc" id="L100">        return new NettyServer(listenAddress, serverConfig, serviceDefinitionList);</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>