<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RpcMessage.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">netty-rpc</a> &gt; <a href="index.source.html" class="el_package">com.yonhoo.nettyrpc.protocol</a> &gt; <span class="el_source">RpcMessage.java</span></div><h1>RpcMessage.java</h1><pre class="source lang-java linenums">package com.yonhoo.nettyrpc.protocol;

import com.yonhoo.nettyrpc.common.RpcConstants;
import java.io.Serializable;
import lombok.Builder;
import lombok.Value;

/**
 * &lt;p&gt;
 * custom protocol decoder
 * &lt;p&gt;
 * &lt;pre&gt;
 *   0     1     2     3     4    5    6    7    8         9            10     11      12    13    14   15  16
 *   +-----+-----+-----+-----+----+----+----+----+---------+------------+------+--------+----+----+-----+----+
 *   |   full length        | magic   code       | version | messageType| codec|compress|    RequestId       |
 *   +-----------------------+--------+---------------------+-----------+-----------+-----------+------------+
 *   |                                                                                                       |
 *   |                                         body                                                          |
 *   |                                                                                                       |
 *   |                                        ... ...                                                        |
 *   +-------------------------------------------------------------------------------------------------------+
 * 4B  magic code（魔法数）   1B version（版本）   4B full length（消息长度）    1B messageType（消息类型）
 * 1B compress（压缩类型） 1B codec（序列化类型）    4B  requestId（请求的Id）
 * body（object类型数据）
 * &lt;/pre&gt;
 **/


<span class="nc bnc" id="L29" title="All 20 branches missed.">@Value</span>
<span class="pc" id="L30">@Builder</span>
public class RpcMessage implements Serializable {
    /**
     * rpc message type
     */
<span class="fc" id="L35">    private byte messageType;</span>
    /**
     * serialization type
     */
<span class="fc" id="L39">    private byte codec;</span>
    /**
     * compress type
     */
<span class="fc" id="L43">    private byte compress;</span>
    /**
     * request id
     */
<span class="fc" id="L47">    private int requestId;</span>
    /**
     * request data
     */
<span class="fc" id="L51">    private Object data;</span>

    public RpcMessage SuccessResponse(Object data) {
<span class="fc" id="L54">        return RpcMessage.builder()</span>
<span class="fc" id="L55">                .requestId(requestId)</span>
<span class="fc" id="L56">                .messageType(RpcConstants.RESPONSE_TYPE)</span>
<span class="fc" id="L57">                .codec(codec)</span>
<span class="fc" id="L58">                .compress(compress)</span>
<span class="fc" id="L59">                .data(data)</span>
<span class="fc" id="L60">                .build();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>